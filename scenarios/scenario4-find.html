<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Truth or Myth? - Find the Problem</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen p-8">

  <div class="max-w-4xl mx-auto">
    <!-- Original Question -->
    <div class="bg-slate-800 p-4 rounded-lg mb-6">
      <h3 class="text-lg font-bold mb-1">What are your three most favorite types of pie?</h3>
      <p class="text-slate-400 text-sm mb-2">Source: Schwan's Consumer Brands N.A. Pie Preference Survey, 2008</p>
      <p class="text-slate-300">A survey asked people to rank their three favorite types of pie. The results are displayed in the chart below.</p>
    </div>
    
    <h2 class="text-2xl font-bold mb-2 text-center">üîç Find the Problem</h2>
    <p class="text-slate-400 text-center mb-8">Click on the part of the chart that is misleading</p>
    
    <!-- Chart (larger) -->
    <div class="bg-slate-800 p-6 rounded-lg">
      <p class="text-sm text-slate-400 mb-4">Pie Preferences (Percentage of respondents)</p>
      <svg width="600" height="400" class="mx-auto block" id="pie-chart-svg">
        <!-- Pie chart will be generated by JavaScript -->
      </svg>
      
      <!-- Note about percentages -->
      <p class="text-slate-500 text-xs mt-4 text-center">*Total adds up to more than 100 percent because people were asked to rank their three favorite types of pie.</p>
    </div>

    <script>
      // Pie chart data with shorter labels
      const pieData = [
        { label: 'Apple', shortLabel: 'Apple', value: 47, color: '#ef4444', option: 'B' },
        { label: 'Pumpkin', shortLabel: 'Pumpkin', value: 37, color: '#f97316', option: 'C' },
        { label: 'Chocolate creme', shortLabel: 'Choc. creme', value: 32, color: '#7c2d12', option: 'D' },
        { label: 'Cherry', shortLabel: 'Cherry', value: 27, color: '#dc2626', option: 'E' },
        { label: 'Apple crumb', shortLabel: 'Apple crumb', value: 25, color: '#ea580c', option: 'F' },
        { label: 'Pecan', shortLabel: 'Pecan', value: 24, color: '#d97706', option: 'G' },
        { label: 'Lemon meringue', shortLabel: 'Lemon m.', value: 24, color: '#fbbf24', option: 'H' },
        { label: 'Blueberry', shortLabel: 'Blueberry', value: 21, color: '#3b82f6', option: 'I' },
        { label: 'Key lime', shortLabel: 'Key lime', value: 18, color: '#22c55e', option: 'J' },
        { label: 'Peach', shortLabel: 'Peach', value: 16, color: '#f59e0b', option: 'K' }
      ];
      
      const total = pieData.reduce((sum, item) => sum + item.value, 0);
      const centerX = 220;
      const centerY = 200;
      const radius = 150;
      let currentAngle = -90; // Start at top (12 o'clock)
      
      const svg = document.getElementById('pie-chart-svg');
      
      pieData.forEach((item, index) => {
        const angle = (item.value / total) * 360;
        const startAngle = currentAngle;
        const endAngle = currentAngle + angle;
        
        // Convert angles to radians
        const startAngleRad = (startAngle * Math.PI) / 180;
        const endAngleRad = (endAngle * Math.PI) / 180;
        
        // Calculate start and end points
        const x1 = centerX + radius * Math.cos(startAngleRad);
        const y1 = centerY + radius * Math.sin(startAngleRad);
        const x2 = centerX + radius * Math.cos(endAngleRad);
        const y2 = centerY + radius * Math.sin(endAngleRad);
        
        // Large arc flag (1 if angle > 180, 0 otherwise)
        const largeArcFlag = angle > 180 ? 1 : 0;
        
        // Create path with clickable option
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', `M ${centerX} ${centerY} L ${x1} ${y1} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`);
        path.setAttribute('fill', item.color);
        path.setAttribute('stroke', '#06b6d4');
        path.setAttribute('stroke-width', '2');
        path.setAttribute('data-option', item.option);
        path.setAttribute('class', 'cursor-pointer');
        path.style.opacity = '1';
        path.addEventListener('mouseenter', function() { this.style.opacity = '0.8'; });
        path.addEventListener('mouseleave', function() { this.style.opacity = '1'; });
        svg.appendChild(path);
        
        // Add percentage and option label on slice
        if (angle > 15) {
          const midAngle = (startAngle + endAngle) / 2;
          const midAngleRad = (midAngle * Math.PI) / 180;
          const labelRadius = radius * 0.65;
          const labelX = centerX + labelRadius * Math.cos(midAngleRad);
          const labelY = centerY + labelRadius * Math.sin(midAngleRad);
          
          // Option letter
          const textOption = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          textOption.setAttribute('x', labelX);
          textOption.setAttribute('y', labelY - 8);
          textOption.setAttribute('fill', '#06b6d4');
          textOption.setAttribute('font-size', '12');
          textOption.setAttribute('font-weight', 'bold');
          textOption.setAttribute('text-anchor', 'middle');
          textOption.setAttribute('dominant-baseline', 'middle');
          textOption.textContent = item.option;
          svg.appendChild(textOption);
          
          // Percentage
          const textPercent = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          textPercent.setAttribute('x', labelX);
          textPercent.setAttribute('y', labelY + 8);
          textPercent.setAttribute('fill', '#ffffff');
          textPercent.setAttribute('font-size', '10');
          textPercent.setAttribute('font-weight', 'bold');
          textPercent.setAttribute('text-anchor', 'middle');
          textPercent.setAttribute('dominant-baseline', 'middle');
          textPercent.textContent = item.value + '%';
          svg.appendChild(textPercent);
        }
        
        currentAngle = endAngle;
      });
      
      // Add legend on the right side
      const legendX = 420;
      let legendY = 80;
      pieData.forEach((item, index) => {
        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        rect.setAttribute('x', legendX);
        rect.setAttribute('y', legendY);
        rect.setAttribute('width', 12);
        rect.setAttribute('height', 12);
        rect.setAttribute('fill', item.color);
        svg.appendChild(rect);
        
        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', legendX + 18);
        text.setAttribute('y', legendY + 9);
        text.setAttribute('fill', '#94a3b8');
        text.setAttribute('font-size', '11');
        text.textContent = item.option + ': ' + item.label + ' (' + item.value + '%)';
        svg.appendChild(text);
        
        legendY += 22;
      });
      
      // Add clickable area for the pie chart format itself (Option A)
      const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
      rect.setAttribute('x', 420);
      rect.setAttribute('y', 20);
      rect.setAttribute('width', 150);
      rect.setAttribute('height', 40);
      rect.setAttribute('fill', 'rgba(6,182,212,0.1)');
      rect.setAttribute('stroke', '#06b6d4');
      rect.setAttribute('stroke-width', '2');
      rect.setAttribute('rx', '5');
      rect.setAttribute('data-option', 'A');
      rect.setAttribute('class', 'cursor-pointer');
      rect.addEventListener('mouseenter', function() { this.setAttribute('fill', 'rgba(6,182,212,0.2)'); });
      rect.addEventListener('mouseleave', function() { this.setAttribute('fill', 'rgba(6,182,212,0.1)'); });
      svg.appendChild(rect);
      
      const textA = document.createElementNS('http://www.w3.org/2000/svg', 'text');
      textA.setAttribute('x', 495);
      textA.setAttribute('y', 45);
      textA.setAttribute('fill', '#06b6d4');
      textA.setAttribute('font-size', '14');
      textA.setAttribute('font-weight', 'bold');
      textA.setAttribute('text-anchor', 'middle');
      textA.textContent = 'A: Chart Format';
      svg.appendChild(textA);
    </script>
    
    <!-- Feedback (hidden by default) -->
    <div id="feedback" class="mt-6 hidden">
      <div id="feedback-box" class="p-4 rounded-lg">
        <p id="feedback-text"></p>
      </div>
    </div>
    
    <!-- Continue button (hidden until correct) -->
    <div id="continue" class="mt-6 hidden text-center">
      <a href="scenario4-real.html" class="bg-cyan-500 hover:bg-cyan-400 text-slate-900 font-semibold px-6 py-3 rounded-lg inline-block">
        Continue ‚Üí
      </a>
    </div>
  </div>
  
  <script src="scenario4-find.js"></script>

</body>
</html>
