<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Truth or Myth?</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white min-h-screen p-8">

  <div class="max-w-2xl mx-auto">
    <h2 class="text-2xl font-bold mb-2">What are your three most favorite types of pie?</h2>
    <p class="text-slate-400 text-sm mb-4">Source: Schwan's Consumer Brands N.A. Pie Preference Survey, 2008</p>
    <p class="bg-slate-800 p-4 rounded-lg mb-6">A survey asked people to rank their three favorite types of pie. The results show that Apple pie is the most popular at 47%, followed by Pumpkin at 37%, and Chocolate creme at 32%.</p>
    
    <!-- Chart -->
    <div class="bg-slate-800 p-4 rounded-lg mb-6">
      <p class="text-sm text-slate-400 mb-4">Pie Preferences (Percentage of respondents)</p>
      <svg width="600" height="400" class="mx-auto block" id="pie-chart-svg">
        <!-- Pie chart will be generated by JavaScript -->
      </svg>
      <p class="text-slate-500 text-xs mt-2 text-center">*Total adds up to more than 100 percent because people were asked to rank their three favorite types of pie.</p>
    </div>

    <script>
      // Pie chart data with shorter labels
      const pieData = [
        { label: 'Apple', shortLabel: 'Apple', value: 47, color: '#ef4444' },
        { label: 'Pumpkin', shortLabel: 'Pumpkin', value: 37, color: '#f97316' },
        { label: 'Chocolate creme', shortLabel: 'Choc. creme', value: 32, color: '#7c2d12' },
        { label: 'Cherry', shortLabel: 'Cherry', value: 27, color: '#dc2626' },
        { label: 'Apple crumb', shortLabel: 'Apple crumb', value: 25, color: '#ea580c' },
        { label: 'Pecan', shortLabel: 'Pecan', value: 24, color: '#d97706' },
        { label: 'Lemon meringue', shortLabel: 'Lemon m.', value: 24, color: '#fbbf24' },
        { label: 'Blueberry', shortLabel: 'Blueberry', value: 21, color: '#3b82f6' },
        { label: 'Key lime', shortLabel: 'Key lime', value: 18, color: '#22c55e' },
        { label: 'Peach', shortLabel: 'Peach', value: 16, color: '#f59e0b' }
      ];
      
      const total = pieData.reduce((sum, item) => sum + item.value, 0);
      const centerX = 250;
      const centerY = 200;
      const radius = 150;
      let currentAngle = -90; // Start at top (12 o'clock)
      
      const svg = document.getElementById('pie-chart-svg');
      
      pieData.forEach((item, index) => {
        const angle = (item.value / total) * 360;
        const startAngle = currentAngle;
        const endAngle = currentAngle + angle;
        
        // Convert angles to radians
        const startAngleRad = (startAngle * Math.PI) / 180;
        const endAngleRad = (endAngle * Math.PI) / 180;
        
        // Calculate start and end points
        const x1 = centerX + radius * Math.cos(startAngleRad);
        const y1 = centerY + radius * Math.sin(startAngleRad);
        const x2 = centerX + radius * Math.cos(endAngleRad);
        const y2 = centerY + radius * Math.sin(endAngleRad);
        
        // Large arc flag (1 if angle > 180, 0 otherwise)
        const largeArcFlag = angle > 180 ? 1 : 0;
        
        // Create path
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', `M ${centerX} ${centerY} L ${x1} ${y1} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`);
        path.setAttribute('fill', item.color);
        path.setAttribute('stroke', '#64748b');
        path.setAttribute('stroke-width', '2');
        svg.appendChild(path);
        
        // Add label - only show if slice is large enough
        if (angle > 15) {
          const midAngle = (startAngle + endAngle) / 2;
          const midAngleRad = (midAngle * Math.PI) / 180;
          const labelRadius = radius * 0.65;
          const labelX = centerX + labelRadius * Math.cos(midAngleRad);
          const labelY = centerY + labelRadius * Math.sin(midAngleRad);
          
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', labelX);
          text.setAttribute('y', labelY);
          text.setAttribute('fill', '#ffffff');
          text.setAttribute('font-size', angle > 30 ? '8' : '7');
          text.setAttribute('font-weight', 'bold');
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('dominant-baseline', 'middle');
          text.textContent = `${item.shortLabel} ${item.value}%`;
          svg.appendChild(text);
        }
        
        currentAngle = endAngle;
      });
      
      // Add legend on the right side
      const legendX = 450;
      let legendY = 50;
      pieData.forEach((item, index) => {
        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        rect.setAttribute('x', legendX);
        rect.setAttribute('y', legendY);
        rect.setAttribute('width', 10);
        rect.setAttribute('height', 10);
        rect.setAttribute('fill', item.color);
        svg.appendChild(rect);
        
        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', legendX + 16);
        text.setAttribute('y', legendY + 8);
        text.setAttribute('fill', '#94a3b8');
        text.setAttribute('font-size', '8');
        text.textContent = `${item.label}: ${item.value}%`;
        svg.appendChild(text);
        
        legendY += 16;
      });
    </script>

    <div id="answers" class="space-y-3">
      <button class="w-full p-4 bg-slate-800 border-2 border-slate-600 rounded-lg text-left hover:border-cyan-400 hover:bg-slate-700 transition" data-answer="true">
        <span class="answer-label text-green-400 font-bold text-lg">✓ TRUE</span>
        <span class="text-slate-400 ml-2">This claim is accurate</span>
      </button>
      <button class="w-full p-4 bg-slate-800 border-2 border-slate-600 rounded-lg text-left hover:border-cyan-400 hover:bg-slate-700 transition" data-answer="false">
        <span class="answer-label text-red-400 font-bold text-lg">✗ FALSE</span>
        <span class="text-slate-400 ml-2">This claim is wrong</span>
      </button>
      <button class="w-full p-4 bg-slate-800 border-2 border-slate-600 rounded-lg text-left hover:border-cyan-400 hover:bg-slate-700 transition" data-answer="misleading">
        <span class="answer-label text-amber-400 font-bold text-lg">⚠ MISLEADING</span>
        <span class="text-slate-400 ml-2">Something's fishy</span>
      </button>
    </div>

    <!-- Feedback (hidden by default) -->
    <div id="feedback" class="mt-6 hidden">
      <div id="feedback-box" class="p-4 rounded-lg">
        <p id="feedback-text"></p>
      </div>
    </div>

    <!-- Continue button (hidden until answered) -->
    <div id="continue" class="mt-6 hidden">
      <a href="scenario4-find.html" class="bg-cyan-500 hover:bg-cyan-400 text-slate-900 font-semibold px-6 py-3 rounded-lg inline-block">
        Continue →
      </a>
    </div>
  </div>

  <script src="scenario4.js"></script>
</body>
</html>
